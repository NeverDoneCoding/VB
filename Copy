Sub CompareAndHighlightRows()
    Dim sourceWorkbook As Workbook
    Dim targetWorkbook As Workbook
    Dim sourceSheet As Worksheet
    Dim targetSheet As Worksheet
    Dim sourceRange As Range
    Dim targetRange As Range
    Dim sourceCell As Range
    Dim targetCell As Range
    Dim sourceFilePath As String
    Dim targetFilePath As String
    Dim sourceSheetName As String
    Dim targetSheetName As String
    Dim compareColumn As String
    Dim sourceLastRow As Long
    Dim targetLastRow As Long
    Dim sourceRow As Range
    Dim targetRow As Range
    
    ' Define variables
    sourceFilePath = "C:\path\to\source\workbook.xlsx"  ' Change to your source workbook path
    targetFilePath = "C:\path\to\target\workbook.xlsx"  ' Change to your target workbook path
    sourceSheetName = "SourceSheet"                     ' Change to your source sheet name
    targetSheetName = "TargetSheet"                     ' Change to your target sheet name
    compareColumn = "A"                                ' Change to your compare column letter
    
    ' Open the source and target workbooks
    Set sourceWorkbook = Workbooks.Open(sourceFilePath)
    Set targetWorkbook = Workbooks.Open(targetFilePath)
    Set sourceSheet = sourceWorkbook.Sheets(sourceSheetName)
    Set targetSheet = targetWorkbook.Sheets(targetSheetName)
    
    ' Find the last row with data in the source and target sheets
    sourceLastRow = sourceSheet.Cells(sourceSheet.Rows.Count, compareColumn).End(xlUp).Row
    targetLastRow = targetSheet.Cells(targetSheet.Rows.Count, compareColumn).End(xlUp).Row
    
    ' Set the ranges to compare
    Set sourceRange = sourceSheet.Range(compareColumn & "2:" & compareColumn & sourceLastRow)
    Set targetRange = targetSheet.Range(compareColumn & "2:" & compareColumn & targetLastRow)
    
    ' Loop through each row in the target range
    For Each targetRow In targetRange.Rows
        Set targetCell = targetRow.Cells(1, 1) ' Assuming the comparison is in the first column
        
        ' Check if the target cell value exists in the source range
        For Each sourceRow In sourceRange.Rows
            Set sourceCell = sourceRow.Cells(1, 1) ' Assuming the comparison is in the first column
            
            If targetCell.Value = sourceCell.Value Then
                ' Highlight the entire row in the target sheet
                targetRow.Interior.Color = RGB(255, 255, 0) ' Yellow color
                Exit For
            End If
        Next sourceRow
    Next targetRow
    
    ' Close the source workbook without saving
    sourceWorkbook.Close False
    
    ' Save and close the target workbook
    targetWorkbook.Save
    targetWorkbook.Close
    
    MsgBox "Comparison and highlighting complete."
End Sub
