Sub ProcessData()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim compColumn As Range
    Dim compAverage As Double
    Dim foundCell As Range
    Dim ruleRoleCell As Range
    Dim headerRange As Range

    ' Set the worksheet to "policy-rule-compliance"
    Set ws = ThisWorkbook.Sheets("policy-rule-compliance")

    ' Step 1: Delete columns A, B, C, D, and the column with the title "Rule role"
    ws.Columns("A:D").Delete

    ' Find the column with the title "Rule role" and delete it
    Set ruleRoleCell = ws.Rows(1).Find(What:="Rule role", LookIn:=xlValues, LookAt:=xlWhole)
    If Not ruleRoleCell Is Nothing Then
        ws.Columns(ruleRoleCell.Column).Delete
    End If

    ' Find the column with the header "Compliance"
    Set foundCell = ws.Rows(1).Find(What:="Compliance", LookIn:=xlValues, LookAt:=xlWhole)
    
    If Not foundCell Is Nothing Then
        ' Step 2: Process rows in column A
        lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
        For i = 2 To lastRow ' Assuming headers are in the first row
            If ws.Cells(i, "A").Value Like "*19.1*" Or _
               ws.Cells(i, "A").Value Like "*19.2*" Or _
               ws.Cells(i, "A").Value Like "*19.3*" Or _
               ws.Cells(i, "A").Value Like "*19.4*" Or _
               ws.Cells(i, "A").Value Like "*19.5*" Or _
               ws.Cells(i, "A").Value Like "*19.6*" Or _
               ws.Cells(i, "A").Value Like "*19.7*" Or _
               ws.Cells(i, "A").Value Like "*19.8*" Or _
               ws.Cells(i, "A").Value Like "*19.9*" Then
                ws.Cells(i, foundCell.Column).Value = 100
            End If
        Next i

        ' Step 3: Calculate the average of the "Compliance" column, excluding the first row
        lastRow = ws.Cells(ws.Rows.Count, foundCell.Column).End(xlUp).Row
        Set compColumn = ws.Range(ws.Cells(2, foundCell.Column), ws.Cells(lastRow, foundCell.Column))
        compAverage = Application.WorksheetFunction.Average(compColumn)
        
        ' Output the average to cell F4
        ws.Range("F4").Value = compAverage

        ' Step 4: Write "Average" in cell F3 and "Instances" in cell G3
        ws.Range("F3").Value = "Average"
        ws.Range("G3").Value = "Instances"

        ' Step 5: Add filters to all headers in the first row
        Set headerRange = ws.Rows(1)
        headerRange.AutoFilter
    Else
        MsgBox "The 'Compliance' column was not found.", vbExclamation
    End If
End Sub
